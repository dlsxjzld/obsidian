“프로토타입은 자바스크립트에서 상속을 지원하기 위한 방법이다.”

여기엔 여러 가지 해소되지 않는 질문이 있습니다. ‘왜 다른 언어처럼 클래스가 아니라 프로토타입인가?’, ‘프로토타입은 어디서 나온 용어인가?’. 이 질문의 답은 쉽게 접할 수 있는 자료에선 찾을 수 없었습니다.

프로토타입 외에도 당황스러웠던, 그리고 어려웠던 부분은 호이스팅과 this였습니다. 대부분의 자료는 자바스크립트에서 구현해놓은 스펙과 현상만을 설명했습니다. 이 또한 ‘왜 자바스크립트만 이렇게 특이하게 처리하지?’ 에 대해 명쾌하게 답해주는 자료를 찾을 수 없었습니다.

개인적으로 어떤 기술에 대해 ‘왜’를 알아야만 해당 기술에 애착이 생기는 편입니다. 이러한 이유로 ‘왜' 에 대해 집중적으로 연구하다가 아주 흥미로운 논문을 발견했습니다. [Classes vs. Prototypes Some Philosophical and Historical Observations](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.56.4713&rep=rep1&type=pdf) 라는 1996년에 작성된 논문인데요, 여기에 제가 궁금했던 ‘왜' 에 대한 내용이 담겨 있었습니다.

이 글은 위 논문을 토대로 제가 이해한 내용을 적은 글입니다. 

앞으로 전개될 글 내용을 미리 요약하면, 프로토타입 기반 OOP는 class 기반의 OOP 와 완전히 상반되는 방식입니다. 객체를 바라보는 개념 자체가 완전히 다릅니다. 특히 문맥(context)을 매우 강조하는 철학적 근거에서 태어난 녀석이라 렉시컬 스코프에 의한 호이스팅과 실행 문맥에 의한 복잡한 this가 필연적으로 발생할 수밖에 없었습니다.

이 글을 통해 저처럼 혼란을 느끼는 분들도 프로토타입의 ‘why’를 깊이 이해할 수 있기를, 더 나아가 호이스팅과 this에 대해서도 보다 근원적인 이해를 할 수 있기를 기대합니다.

----

# 플라톤과 이데아, 그리고 클래스 기반 객체지향프로그래밍

서양철학은 이분법적 세계관을 갖고 있습니다.
- 영혼 / 육체
- 추상적 / 구체적
- 이데아 / 프랙티스

눈앞에 실제로, 구체적으로 존재하는 사물이 있다면 반드시 그것의 본질이 존재한다는 것이 플라톤의 주장입니다.
- chair : 이데아에 존재하는 본질적인, 추상적인 의자. 현실세계에 존재하지 않는다
- a chair, the chair, chairs : 현실 세계에 존재하는 의자

이러한 사고방식이 프로그래밍 언어에도 자연스럽게 녹아들어 생긴 언어가 “클래스 기반 객체지향 프로그래밍 언어”입니다. 대표적으로 Java, C# 이 있습니다.

Java에서의 예를 볼까요?

```java
class Chair {       
...   
}
Chair myChair = new Chair();
```

위 코드에서 레퍼런스 타입이라 불리는 Chair 클래스는 이데아에 존재하는 추상적인 개념입니다. 
즉, 코드상으로만 존재하지 실제 메모리상에는 존재하지 않습니다. (디테일하게 들어가면 PermGen 영역에 있겠지만 여기서는 Heap 메모리만 실존하는 공간으로 보겠습니다)

그럼 현실세계에 존재하게 하려면 어떻게 해야 할까요? 바로 new 키워드를 사용하면 됩니다. 
new Chair() 를 하는 순간 추상적으로만 존재하던 의자가 메모리라는 현실세계에 구체적으로 존재(인스턴스화)하게 됩니다.

이러한 클래스 방식의 OOP 언어는 플라톤류(Platonic) 서양철학의 자연스러운 흐름입니다.

# 분류(Classification)

이러한 플라톤의 이데아 이론은 그의 제자 아리스토텔레스에 의해서 ‘분류(classification)'란 개념으로 정립됩니다. class 라는 키워드가 어디서 나온 지 알 수 있겠죠? 아리스토텔레스는 아래와 같이 분류를 정리했습니다.

- `개체의 속성이 동일한 경우` 개체 그룹이 같은 범주에 속한다. 범주는 정의와 구별의 합이다

이는 전통적인 클래스 기반 객체 지향 프로그래밍의 아이디어-일반화(generalization)와 정확히 일치합니다. 여기서 속성은 클래스의 프로퍼티가 되겠죠. 프로퍼티가 유사한 객체가 있다면 일반화 과정을 통해 클래스로 추상화됩니다.

# 프로토타입(Prototype)

프로토타입이란 개념이 이 분류(Classification)이론을 정면으로 반박하여 나온 이론이기 때문입니다.

19세기 매우 유명한 철학자 비트겐슈타인은 아리스토텔레스의 분류 개념을 정면으로 반박합니다

> 공유 속성의 관점에서 정의하기 어려운 개념이 있다(사실상 올바른 분류란 없다) — 비트겐슈타인

이 얘기를 하면서 근거로 들고 온 것은 바로 게임입니다. 게임은 일반적으로 승리와 패배가 명확합니다. 즉 ‘승리'와 ‘패배'라는 속성이 있다고 볼 수 있죠. 하지만 비트겐슈타인은 이에 대한 반론으로 ‘승리', ‘패배'가 없는 `ring around a rosy`를 들고옵니다.

이처럼 게임에는 공유 속성이 없습니다.

- 승리 / 패배? ring around a rosy 게임엔 없잖아
- 숙련도 여부? 행운(주사위) 위주 게임은 없잖아
- 플레이어 존재여부? 플레이어가 전혀 필요하지 않는 게임도 있잖아

특히 게임 외에도 예술작품의 경우 공통 속성을 정의할 수 없습니다. 즉, 좀 더 철학적으로 본다면 ‘게임', ‘예술' 등의 단어는 결코 속성으로 규정할 수 없지요.

> 세계에 미리 내재되어서 대상과 언어를 완전히 규정하는 어떤 언어란 존재하지 않는다 — 비트겐슈타인

이러한 분류(Classification)에 대해 강하게 비판한 비트겐슈타인, 그렇다면 그의 대안은 무엇이었을까요? 
비트겐슈타인은 다음의 유명한 말을 남깁니다.

> 표현은 삶의 흐름 속에서만 의미를 갖는다 — 비트겐슈타인

마음에 울림이 있는 문구입니다. 이 내용을 좀 더 살펴보겠습니다.
# 의미사용이론(the use theory of meaning)

비트겐슈타인 일생의 후기에 내놓은 이론입니다. 사용(use)에 의해 의미(meaning)가 결정된다는 이론입니다. 단어의 쓰임새가 곧 의미가 됩니다. 즉, 단어의 **‘진정한 본래의 의미'란 존재하지 않고 ‘상황과 맥락에 의해서 결정된다'** 라고 주장하고 있습니다. 그러니 단어의 의미를 백날 분석해봤자 소용이 없다는 것입니다.

비트겐슈타인은 ‘벽돌'을 예로 들었습니다. 누군가 벽돌! 이라 외쳤을 때 상황마다 그 의미는 달라집니다

- (벽돌이 필요할 때) : 벽돌을 달라
- (벽돌로 보수해야 할 때) : 벽돌을 채우라
- (벽돌이 떨어질 때) : 벽돌을 피해라

위 내용이 어렵다면 **맥락(Context)이 중요**하다는 것만 기억하시면 됩니다. 이 **컨텍스트**로 **프로토타입 기반 언어의 실행 컨텍스트**를 설명할 수 있습니다.
# 가족 유사성(Family Resemblance)

비트겐슈타인은 위에서 설명한 의미사용이론과 또 하나의 이론을 주장합니다. 바로 가족 유사성입니다.![](https://miro.medium.com/v2/resize:fit:1274/1*M8Z3pB6HloC2pM8UJIOjtA.png)

비트겐슈타인은 인간이 현실에서 실제로 대상을 분류할 때 속성(전통적인 분류에서의 기준)이 아닌 가족 유사성을 통해 분류하게 된다고 얘기합니다.

위 그림처럼 가족이 있을 때 이 가족이 모두 공유하는 공통 속성은 없습니다. 갈색 머리, 안경, 수염, 큰 코가 가족의 전형적인 특징이라고 하더라도 모든 가족 구성원에게 적용되는 공통된 특성(속성)은 없을 수 있습니다. 그런데도 우리는 이 그림을 보고 전형적인 특징을 통해 ‘가족'으로 분류합니다. 이런 분류 방식을 ‘가족 유사성' 에 의한 분류라고 합니다.

이 이론은 프로토타입 이론의 근거가 됩니다.
# Rosch 의 프로토타입 이론

이 프로토타입이 바로 Javascript에서 사용하는 프로토타입입니다.
1975년에 Rosch 는 한 가지 실험을 합니다.

- 실험 참가자들에게 여러 범주 구성원(사과, 코코넛, 오렌지)의 속성을 적어보라고 함
- 각 범주 구성원에 대해 범주의 다른 구성원과 공유하는 속성의 개수를 도출함
- 사과, 오렌지 : 2점(둥글다. 즙이 있다.)
- 코코넛 : 1점(둥글다)

점수가 높을수록 ‘가족 유사성'이 높다고 볼 수 있습니다. 전통적인 분류에선 모두 과일로 볼 수 있지만, 프로토타입 이론에서는 사과와 오렌지가 가장 전형적인 무언가라고 볼 수 있습니다. 반면에 코코넛은 저 중에서 가장 비전형적인 것으로 볼 수 있습니다.

이 실험을 통해 로쉬는 “인간은 ‘등급이 매겨진 (개념) 구조(graded structure)’를 가진다”라고 주장합니다. 인간은 사물을 분류할 때 자연스럽게 가장 유사성 높은 것 순서대로 등급을 매긴다는 의미로 볼 수 있습니다. 이렇게 분류했을 때 가장 높은 등급을 가진 녀석이 나올 텐데요, 이것이 바로 원형(Prototype)이다. 란 주장이 프로토타입 이론입니다.

‘새'를 예로 들어볼까요?

‘참새'는 새의 범주를 대표할 만한 가장 전형적인 녀석입니다. 이 녀석을 ‘원형(prototype)'으로 간주하겠습니다.![](https://miro.medium.com/v2/resize:fit:1400/1*ThdtLo8MUCQ2bcfII6AJcQ.png)

‘타조'는 전통적인 분류에선 같은 새가 되지만 프로토타입 이론에서는 ‘원형'에서 가장 멀리 떨어진, 즉 ‘비전형적인' 녀석이 됩니다. 범주의 가장 끄트머리에 있는 녀석이 되는 거죠.

즉, **객체는 ‘정의’로부터 분류되는 것이 아니라 가장 좋은 보기(prototype, exemplar)로부터 범주화**된다고 합니다.

이러한 분류 체계는 매우 경제적입니다. 만약 우리가 새로운 대상을 접해서 분류해야 할 때, 우리는 **새로운 대상의 몇 가지 특징만 원형(prototype)과 비교확인**만 하면 됩니다. **특징이 다를수록 원형에서 멀~리 떨어진 범주**가 되는 거죠.

이 이론에 또 한 가지 중요한 것이 있습니다.

**같은 단어라 할지라도 누가 어떤 상황(context)에서 접했나에 따라 의미가 달라진다**는 것입니다. (의미사용이론)

예를 들면 아이가 생각하는 새의 범주에서 ‘참새’는 명확하게 새에 속하지만 ‘펭귄' 은 해당 범주에 속하지 못할 수도 있습니다. 아이가 생각할 땐 펭귄이 매우 비전형적이기 때문이죠. 하지만 조류학자가 생각할 때 ‘참새'와 ‘펭귄'은 명확하게 유사한 새의 범주에 속할 수 있습니다. 같은 단어여도 어떤 상황(누가, 어디서…)에서 접했나에 따라 범주는 크게 달라집니다.

- **현실에 존재하는 것 중 가장 좋은 본보기를 원형(prototype)으로 선택한다.**
- **문맥(컨텍스트)에 따라 ‘범주’, 즉 ‘의미’가 달라진다.**

# 프로토타입 기반 객체지향 프로그래밍

https://medium.com/@limsungmook/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%8A%94-%EC%99%9C-%ED%94%84%EB%A1%9C%ED%86%A0%ED%83%80%EC%9E%85%EC%9D%84-%EC%84%A0%ED%83%9D%ED%96%88%EC%9D%84%EA%B9%8C-997f985adb42